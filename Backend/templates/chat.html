<!DOCTYPE html>
<html>
<head>
  <title>AnyChat - Global Chat</title>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
  <h2>üåê AnyChat Global Chat</h2>
  <p>You are chatting as: <strong>{{ nickname }}</strong></p>

  <ul id="messages"></ul>

  <input id="msg" placeholder="Type a message...">
  <button onclick="sendMessage()">Send</button>

  <script>
    const nickname = "{{ nickname }}";  // passed from Flask
    const socket = io();

      socket.on("connect", () => {
      console.log("‚úÖ Connected!");
      socket.emit("join", { nickname });
    });
    
    socket.on("message", (data) => {
      let li = document.createElement("li");
      li.textContent = data;
      document.getElementById("messages").appendChild(li);
    });

    function sendMessage() {
      let msg = document.getElementById("msg").value;
      if (msg.trim() !== "") {
        socket.send("[" + nickname + "]: " + msg);
        document.getElementById("msg").value = "";
      }
    }

    // allow Enter key to send
    document.getElementById("msg").addEventListener("keyup", function(event) {
      if (event.key === "Enter") {
        sendMessage();
      }
    });
  </script>
</body>
</html>
